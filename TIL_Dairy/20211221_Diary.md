### 今日の目標
- rspecの基本を理解する
 
### 今日の積み上げ
- テストを書くためのメリット
開発した機能を確認するために、テストを書くことが大切である。アプリケーションに機能が追加される度に、様々な既存機能が想定通りに動いているか確認する必要がある。これは非常に時間がかかるが、自動テストを備えていれば動作確認の大部分を任せることができる。また、自分がどのように動くコードを書いているのかを記録に残し、常に動くことを確認しながら開発ができるので、安心して開発をすすめることができるので、確実性を高めることができ最終的に開発時間を節約してくれる。

- RSpec
RubyにおけるBDD（振舞駆動開発）のためのテスティングフレームワークである。

- Capybara
Webアプリケーションのブランチ操作をシミュレーションできるほか、実際のブラウザと組み合わせてJavaScriptの動作まで含めたテストを行うことができる。

- FactoryBot
テスト用データの作成をサポートするgemである。`ActiveRecord`モデルに実装したコールバックなどの資産を直接的に活用してデータの状態やデータ間の関係性などを制御しやすくなる。

- モデルスペック(Model spec)
モデルが正しく機能しているかテストする。バリテーションに使われることが多い。

- リクエストスペック
`GET/POST/DELETE`などのリクエストを送った時、正しいレスポンスが返ってくるかテストする。例えば、POSTリクエストなら正しくデータが登録されるかなどをテストする。

- システムスペック
ユーザーの立場に立って、想定通りの画面操作が行えるかどうかテストする。例えば、リンクをクリックして、フォームに値を入力するなどの操作を一つ一つ行いながらテストする。

- gemの説明
`gem 'capybara'`
「visit」「click_link」「fill_in」などのコマンドを使えるようになる。

`gem 'spring-commands-rspec'`
binstubをインストールしてテストの起動時間を早くする設定を行う。

`gem 'rails-controller-testing'`
便利なマッチャーを提供してくれる。

`gem 'webdrivers'`
Chromeとやりとりするのに必要なChromeDriverを含む。

`gem 'devise'`
ログインなどの認証処理い便利なヘルパーを提供する。

`gem 'factory_bot_rails'`
ファクトリを使えるようにするrails用gem

- `Factory Bot`でのシーケンス
ファクトリから新しいオブジェクトを作成する度に、カウントを一つずつ増やしながらユニークな属性に値を設定する。
```
FactoryBot.define do
  factory :user do
    name { Faker::Name.name }
    nickname { Faker::Name.name }
    sequence(:email) { |n| "example#{n}@example.com" }
    password { "password" }
    password_confirmation { "password" }
  end
end
```

- letの遅延評価
`let(:user){create(:user)}`
`user = create(:user)`ほぼ同義である。違いとしては、letを使うと遅延評価となりuserという変数が必要とされるまで式が実行されない。
`create(:user)`によってユーザーファクトリからサンプルユーザーを作成し、userという変数に代入する。


### 反省
- letの使い方はよくわからないので実際に使ってみて見よう
